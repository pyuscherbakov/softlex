{% extends 'base.html' %}

{% block title %}{{ test_case.title }} - Softlex{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2><i class="bi bi-list-check"></i> {{ test_case.title }}</h2>
        <p class="text-muted">
            <span class="badge bg-primary">{{ test_case.project.name }}</span>
            <small class="ms-2">
                <i class="bi bi-calendar"></i> {{ test_case.created_at|date:"d.m.Y H:i" }}
            </small>
        </p>
    </div>
    <div>
        <a href="{% url 'testcases:testcase_edit' test_case.pk %}" class="btn btn-outline-secondary">
            <i class="bi bi-pencil"></i> Редактировать
        </a>
        <a href="{% url 'testcases:testcase_delete' test_case.pk %}" class="btn btn-outline-danger">
            <i class="bi bi-trash"></i> Удалить
        </a>
        <a href="{% url 'testcases:testcase_list' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Назад к тест-кейсам
        </a>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-info-circle"></i> Информация о тест-кейсе</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="bi bi-tag"></i> Название</h6>
                        <p>{{ test_case.title }}</p>
                        
                        <h6><i class="bi bi-folder"></i> Проект</h6>
                        <p>
                            <a href="{% url 'testcases:project_detail' test_case.project.pk %}" class="text-decoration-none">
                                {{ test_case.project.name }}
                            </a>
                        </p>
                        
                        <h6><i class="bi bi-person"></i> Создатель</h6>
                        <p>{{ test_case.created_by.email }}</p>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="bi bi-calendar"></i> Дата создания</h6>
                        <p>{{ test_case.created_at|date:"d.m.Y H:i" }}</p>
                        
                        <h6><i class="bi bi-clock"></i> Последнее обновление</h6>
                        <p>{{ test_case.updated_at|date:"d.m.Y H:i" }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-file-text"></i> Описание</h5>
            </div>
            <div class="card-body">
                {% if test_case.description %}
                    <p>{{ test_case.description|linebreaks }}</p>
                {% else %}
                    <p class="text-muted">Описание не указано</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-list-ol"></i> Предусловия</h5>
            </div>
            <div class="card-body">
                {% if test_case.preconditions %}
                    <p>{{ test_case.preconditions|linebreaks }}</p>
                {% else %}
                    <p class="text-muted">Предусловия не указаны</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-list-nested"></i> Шаги выполнения</h5>
            </div>
            <div class="card-body">
                <p>{{ test_case.steps|linebreaks }}</p>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-check-circle"></i> Ожидаемый результат</h5>
            </div>
            <div class="card-body">
                <p>{{ test_case.expected_result|linebreaks }}</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function editTestCase(testCaseId) {
    // TODO: Реализовать редактирование тест-кейса
    console.log('Edit test case:', testCaseId);
}

function deleteTestCase(testCaseId) {
    if (confirm('Вы уверены, что хотите удалить этот тест-кейс?')) {
        // TODO: Реализовать удаление тест-кейса
        console.log('Delete test case:', testCaseId);
    }
}
</script>
{% endblock %}
